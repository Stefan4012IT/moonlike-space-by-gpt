(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(o){if(o.ep)return;o.ep=!0;const t=i(o);fetch(o.href,t)}})();let l,c,I=[],f=[];function P(e){c=e,l=c.getContext("2d");function n(){c.width=window.innerWidth,c.height=window.innerHeight}n(),window.addEventListener("resize",n);const i=150;I=[];for(let s=0;s<i;s++)I.push({x:Math.random()*c.width,y:Math.random()*c.height,radius:Math.random()*1.5,alpha:Math.random(),delta:Math.random()*.02});c.addEventListener("mousemove",s=>{f.push({x:s.clientX,y:s.clientY,alpha:1,radius:Math.random()*4+1})})}function L(){l.clearRect(0,0,c.width,c.height);for(let e of I)e.alpha+=e.delta,(e.alpha<=0||e.alpha>=1)&&(e.delta*=-1),l.beginPath(),l.arc(e.x,e.y,e.radius,0,Math.PI*2),l.fillStyle=`rgba(255, 255, 255, ${e.alpha})`,l.fill();for(let e=0;e<f.length;e++){const n=f[e];l.beginPath(),l.arc(n.x,n.y,n.radius,0,Math.PI*2),l.fillStyle=`rgba(173, 216, 230, ${n.alpha})`,l.fill(),n.alpha-=.02,n.alpha<=0&&(f.splice(e,1),e--)}requestAnimationFrame(L)}function O(){const e=document.getElementById("stars");if(!e)return;const n=e.getContext("2d"),i=[];for(let o=0;o<300;o++)i.push({x:Math.random()*e.width-e.width/2,y:Math.random()*e.height-e.height/2,z:Math.random()*e.width/2});function s(){n.clearRect(0,0,e.width,e.height);for(let o of i){o.z-=.5,o.z<=.1&&(o.x=Math.random()*e.width-e.width/2,o.y=Math.random()*e.height-e.height/2,o.z=e.width/2);const t=o.x/o.z*e.width+e.width/2,a=o.y/o.z*e.height+e.height/2,m=(1-o.z/(e.width/2))*2;n.beginPath(),n.arc(t,a,m,0,Math.PI*2),n.fillStyle="rgba(255, 255, 255, 0.6)",n.fill()}requestAnimationFrame(s)}s()}let b;function Y(e){b=e.getContext("2d"),n(),window.addEventListener("resize",n);function n(){e.width=window.innerWidth,e.height=window.innerHeight}const i=[];window.addEventListener("mousemove",t=>{i.push({x:t.clientX,y:t.clientY,alpha:1,size:8+Math.random()*4,angle:0})});function s(t,a,m,u,h){t.save(),t.translate(a,m),t.scale(u/10,u/10),t.beginPath(),t.moveTo(0,0),t.bezierCurveTo(-1,-1,-2,1,0,2),t.bezierCurveTo(2,1,1,-1,0,0),t.closePath(),t.strokeStyle=`rgba(0, 255, 255, ${h})`,t.lineWidth=.3,t.stroke(),t.restore()}function o(){b.clearRect(0,0,e.width,e.height);for(let t=0;t<i.length;t++){const a=i[t];s(b,a.x,a.y,a.size,a.alpha),a.alpha-=.01,a.alpha<=0&&(i.splice(t,1),t--)}requestAnimationFrame(o)}o()}function N(e){localStorage.setItem("moonlike-echo",e);let n=JSON.parse(localStorage.getItem("moonlike-echo-history")||"[]");n.includes(e)||(n.push(e),localStorage.setItem("moonlike-echo-history",JSON.stringify(n)))}function M(){const e=document.getElementById("echo-list"),n=document.getElementById("echo-log"),i=localStorage.getItem("moonlike-echo-history");if(!i||!e||!n)return;const s=JSON.parse(i);e.innerHTML="",s.forEach(o=>{const t=document.createElement("li");t.textContent=o,e.appendChild(t)}),n.classList.add("visible")}function W(){localStorage.removeItem("moonlike-echo"),localStorage.removeItem("moonlike-echo-history")}function q(){const e=document.getElementById("fragment");e&&(e.classList.add("glitch"),setTimeout(()=>{e.classList.remove("glitch")},500))}function F(e,n=[]){e&&document.body.addEventListener("click",i=>{const s=i.target;n.some(t=>s.closest(t))||(e.paused?e.play().catch(()=>{}):e.pause())})}const x=["You arrived exactly when you were meant to.","The gravity here feels optional.","Nothing happens here, but you feel everything.","Someone dreamed of you before you existed.","This place is made of memory and static.","The stars don’t speak – they listen.","It’s always night here, but no one sleeps.","You’re not lost. You’re just early."];function S(){const e=Math.floor(Math.random()*x.length);return x[e]}function R(){const e=document.getElementById("blackout-flash");e&&(e.style.opacity="1",setTimeout(()=>{e.style.opacity="0"},400))}function z(){const e=Math.floor(Math.random()*6e4)+3e4;setTimeout(()=>{R(),z()},e)}function T(e,n){if(!e)return;const i=Math.floor(Math.random()*2e4)+1e4;setTimeout(()=>{n||(q(),setTimeout(()=>{e.textContent=S(),T(e,n)},300))},i)}let k;function A({whisperId:e="inactivity-whisper",delay:n=6e4,shiftedRef:i}){const s=document.getElementById(e);function o(){s&&!i()&&s.classList.add("visible")}function t(){s&&s.classList.remove("visible")}function a(){clearTimeout(k),t(),k=setTimeout(()=>{o()},n)}window.addEventListener("mousemove",a),a()}const H=document.getElementById("stars");P(H);L();let p=!1;const r=document.getElementById("fragment");r.textContent=S();r.textContent=S();T(r,p);A({shiftedRef:()=>p});const C=document.getElementById("reentry-message"),J=localStorage.getItem("moonlike-echo");J&&C&&setTimeout(()=>{C.classList.add("visible")},3e3);const d=document.querySelector(".container"),w=document.getElementById("hidden-message"),y=document.getElementById("shift-sound"),g=document.createElement("button");r.addEventListener("click",()=>{p||(p=!0,y.volume=.4,y==null||y.play(),document.body.classList.add("shifted"),d.classList.add("fade-out","blur"),w==null||w.classList.add("gone"),setTimeout(()=>{r.textContent="You’re now within.",d.classList.remove("blur"),setTimeout(()=>{d.classList.remove("fade-out")},100);const e=document.getElementById("echo-container"),n=document.getElementById("echo-input");if(e){e.classList.remove("hidden"),e.classList.add("visible"),M();const i=document.getElementById("portal");i&&r&&(setTimeout(()=>{i.classList.add("visible"),r.style.display="none"},4e3),i==null||i.addEventListener("click",()=>{document.body.classList.add("portal-transition"),r.classList.remove("fragment-fade"),r.textContent="",i.classList.remove("visible"),d.classList.add("fade-out"),setTimeout(()=>{var t,a,m,u,h,B;d.style.display="none",(t=document.getElementById("echo-log"))==null||t.remove(),(a=document.getElementById("echo-container"))==null||a.remove(),(m=document.getElementById("reentry-message"))==null||m.remove(),(u=document.getElementById("portal"))==null||u.remove(),(h=document.getElementById("fragment"))==null||h.remove(),(B=document.getElementById("hidden-message"))==null||B.remove();const o=document.createElement("div");o.classList.add("second-layer"),o.innerHTML="<p>You've crossed into the place where nothing remains... and yet something always returns.</p>",document.body.appendChild(o),g.id="return-btn",g.innerText="Return",o.appendChild(g),setTimeout(()=>{const v=document.createElement("canvas");v.id="infinity-canvas",document.body.appendChild(v),Y(v),O()},300)},1e3)}));let s;n==null||n.addEventListener("input",o=>{const t=o.target.value.trim();localStorage.setItem("moonlike-echo",t),clearTimeout(s),s=setTimeout(()=>{if(t==="")return;let a=JSON.parse(localStorage.getItem("moonlike-echo-history")||"[]");a.includes(t)||(a.push(t),localStorage.setItem("moonlike-echo-history",JSON.stringify(a)),N(t),M())},2e3)})}},2e3))});z();T();F(document.getElementById("bg-audio"),["#portal","#return-btn","#exit-btn",".echo-button","#echo-input"]);setTimeout(()=>{const e=document.getElementById("hidden-message");e&&e.classList.add("visible")},7e3);console.log("You’re not lost. You’re just early.");const E=document.getElementById("exit-btn");E==null||E.addEventListener("click",()=>{W();const e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.background="#000",e.style.transition="opacity 2s ease",e.style.opacity="0",e.style.zIndex="9999",document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{location.reload()},3e3)});g.addEventListener("click",()=>{var e,n,i;(e=document.querySelector(".second-layer"))==null||e.remove(),(n=document.getElementById("infinity-canvas"))==null||n.remove(),d.style.display="block",(i=document.getElementById("portal"))==null||i.classList.add("visible"),r.style.display="block",r.textContent="You’re now within.",document.body.classList.add("shifted"),d.classList.add("fade-out","blur"),L()});
