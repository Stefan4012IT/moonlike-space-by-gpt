(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(o){if(o.ep)return;o.ep=!0;const t=s(o);fetch(o.href,t)}})();let d,m,B=[],w=[];function F(e){m=e,d=m.getContext("2d");function n(){m.width=window.innerWidth,m.height=window.innerHeight}n(),window.addEventListener("resize",n);const s=150;B=[];for(let a=0;a<s;a++)B.push({x:Math.random()*m.width,y:Math.random()*m.height,radius:Math.random()*1.5,alpha:Math.random(),delta:Math.random()*.02});m.addEventListener("mousemove",a=>{w.push({x:a.clientX,y:a.clientY,alpha:1,radius:Math.random()*4+1})})}function M(){d.clearRect(0,0,m.width,m.height);for(let e of B)e.alpha+=e.delta,(e.alpha<=0||e.alpha>=1)&&(e.delta*=-1),d.beginPath(),d.arc(e.x,e.y,e.radius,0,Math.PI*2),d.fillStyle=`rgba(255, 255, 255, ${e.alpha})`,d.fill();for(let e=0;e<w.length;e++){const n=w[e];d.beginPath(),d.arc(n.x,n.y,n.radius,0,Math.PI*2),d.fillStyle=`rgba(173, 216, 230, ${n.alpha})`,d.fill(),n.alpha-=.02,n.alpha<=0&&(w.splice(e,1),e--)}requestAnimationFrame(M)}function $(){const e=document.getElementById("stars");if(!e)return;const n=e.getContext("2d"),s=[];for(let o=0;o<300;o++)s.push({x:Math.random()*e.width-e.width/2,y:Math.random()*e.height-e.height/2,z:Math.random()*e.width/2});function a(){n.clearRect(0,0,e.width,e.height);for(let o of s){o.z-=.5,o.z<=.1&&(o.x=Math.random()*e.width-e.width/2,o.y=Math.random()*e.height-e.height/2,o.z=e.width/2);const t=o.x/o.z*e.width+e.width/2,i=o.y/o.z*e.height+e.height/2,y=(1-o.z/(e.width/2))*2;n.beginPath(),n.arc(t,i,y,0,Math.PI*2),n.fillStyle="rgba(255, 255, 255, 0.6)",n.fill()}requestAnimationFrame(a)}a()}let L;function A(e){L=e.getContext("2d"),n(),window.addEventListener("resize",n);function n(){e.width=window.innerWidth,e.height=window.innerHeight}const s=[];window.addEventListener("mousemove",t=>{s.push({x:t.clientX,y:t.clientY,alpha:1,size:8+Math.random()*4,angle:0})});function a(t,i,y,f,l){t.save(),t.translate(i,y),t.scale(f/10,f/10),t.beginPath(),t.moveTo(0,0),t.bezierCurveTo(-1,-1,-2,1,0,2),t.bezierCurveTo(2,1,1,-1,0,0),t.closePath(),t.strokeStyle=`rgba(0, 255, 255, ${l})`,t.lineWidth=.3,t.stroke(),t.restore()}function o(){L.clearRect(0,0,e.width,e.height);for(let t=0;t<s.length;t++){const i=s[t];a(L,i.x,i.y,i.size,i.alpha),i.alpha-=.01,i.alpha<=0&&(s.splice(t,1),t--)}requestAnimationFrame(o)}o()}const C=["You arrived exactly when you were meant to.","The gravity here feels optional.","Nothing happens here, but you feel everything.","Someone dreamed of you before you existed.","This place is made of memory and static.","The stars don’t speak – they listen.","It’s always night here, but no one sleeps.","You’re not lost. You’re just early."],Y=document.getElementById("stars");F(Y);M();function O(){const e=Math.floor(Math.random()*C.length);return C[e]}const r=document.getElementById("fragment");r.textContent=O();const z=document.getElementById("reentry-message"),R=localStorage.getItem("moonlike-echo");R&&z&&setTimeout(()=>{z.classList.add("visible")},3e3);const h=document.querySelector(".container"),I=document.getElementById("hidden-message");let p=!1;const v=document.getElementById("shift-sound"),E=document.createElement("button");r.addEventListener("click",()=>{p||(p=!0,v.volume=.4,v==null||v.play(),document.body.classList.add("shifted"),h.classList.add("fade-out","blur"),I==null||I.classList.add("gone"),setTimeout(()=>{r.textContent="You’re now within.",h.classList.remove("blur"),setTimeout(()=>{h.classList.remove("fade-out")},100);const e=document.getElementById("echo-container"),n=document.getElementById("echo-input");if(e){let t=function(){const l=localStorage.getItem("moonlike-echo-history");if(!l)return;const c=JSON.parse(l);o.innerHTML="",c.forEach(u=>{const g=document.createElement("li");g.textContent=u,o.appendChild(g)}),a.classList.add("visible")};var s=t;e.classList.remove("hidden"),e.classList.add("visible");const a=document.getElementById("echo-log"),o=document.getElementById("echo-list");t();const i=document.getElementById("portal");i&&r&&(setTimeout(()=>{i.classList.add("visible"),r.style.display="none"},4e3),i==null||i.addEventListener("click",()=>{document.body.classList.add("portal-transition"),r.classList.remove("fragment-fade"),r.textContent="",i.classList.remove("visible"),h.classList.add("fade-out"),setTimeout(()=>{var c,u,g,S,k,x;h.style.display="none",(c=document.getElementById("echo-log"))==null||c.remove(),(u=document.getElementById("echo-container"))==null||u.remove(),(g=document.getElementById("reentry-message"))==null||g.remove(),(S=document.getElementById("portal"))==null||S.remove(),(k=document.getElementById("fragment"))==null||k.remove(),(x=document.getElementById("hidden-message"))==null||x.remove();const l=document.createElement("div");l.classList.add("second-layer"),l.innerHTML="<p>You've crossed into the place where nothing remains... and yet something always returns.</p>",document.body.appendChild(l),E.id="return-btn",E.innerText="Return",l.appendChild(E),setTimeout(()=>{const b=document.createElement("canvas");b.id="infinity-canvas",document.body.appendChild(b),A(b),$()},300)},1e3)}));const y=localStorage.getItem("moonlike-echo");y&&n&&(n.value=y);let f;n==null||n.addEventListener("input",l=>{const c=l.target.value.trim();localStorage.setItem("moonlike-echo",c),clearTimeout(f),f=setTimeout(()=>{if(c==="")return;let u=JSON.parse(localStorage.getItem("moonlike-echo-history")||"[]");u.includes(c)||(u.push(c),localStorage.setItem("moonlike-echo-history",JSON.stringify(u)),t())},2e3)})}},2e3))});function H(){const e=document.getElementById("blackout-flash");e&&(e.style.opacity="1",setTimeout(()=>{e.style.opacity="0"},400))}function N(){const e=Math.floor(Math.random()*6e4)+3e4;setTimeout(()=>{p||H(),N()},e)}N();function J(){r.classList.add("glitch"),setTimeout(()=>{r.classList.remove("glitch")},400)}function W(){const e=Math.floor(Math.random()*2e4)+1e4;setTimeout(()=>{p||(J(),setTimeout(()=>{r.textContent=O(),W()},300))},e)}W();window.addEventListener("click",()=>{const e=document.getElementById("bg-audio");e&&e.paused&&(e.play().catch(()=>console.log("Autoplay blocked")),e.volume=.1)});const X=[];Y.addEventListener("mousemove",e=>{X.push({x:e.clientX,y:e.clientY,alpha:1,radius:Math.random()*4+1})});setTimeout(()=>{const e=document.getElementById("hidden-message");e&&e.classList.add("visible")},7e3);console.log("You’re not lost. You’re just early.");const T=document.getElementById("exit-btn");T==null||T.addEventListener("click",()=>{localStorage.removeItem("moonlike-echo"),localStorage.removeItem("moonlike-echo-history");const e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.background="#000",e.style.transition="opacity 2s ease",e.style.opacity="0",e.style.zIndex="9999",document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{location.reload()},3e3)});let P;function j(){const e=document.getElementById("inactivity-whisper");e&&!p&&e.classList.add("visible")}function D(){const e=document.getElementById("inactivity-whisper");e&&e.classList.remove("visible")}function q(){clearTimeout(P),D(),P=setTimeout(()=>{j()},6e3)}window.addEventListener("mousemove",q);q();E.addEventListener("click",()=>{var e,n,s;(e=document.querySelector(".second-layer"))==null||e.remove(),(n=document.getElementById("infinity-canvas"))==null||n.remove(),h.style.display="block",(s=document.getElementById("portal"))==null||s.classList.add("visible"),r.style.display="block",r.textContent="You’re now within.",document.body.classList.add("shifted"),h.classList.add("fade-out","blur"),M()});
